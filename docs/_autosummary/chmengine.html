
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>chmengine &#8212; ChessMoveHeatmap 000.069.420 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="chmengine.engines" href="chmengine.engines.html" />
    <link rel="prev" title="standalone_color_legend" href="standalone_color_legend.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-chmengine">
<span id="chmengine"></span><h1>chmengine<a class="headerlink" href="#module-chmengine" title="Permalink to this heading">¶</a></h1>
<p>A silly chess engine that picks moves using heatmaps</p>
<dl class="py class">
<dt class="sig sig-object py" id="chmengine.CMHMEngine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">CMHMEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chmengine.CMHMEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A silly chess engine that picks moves using heatmaps.</p>
<p>This class manages a chess board and evaluates moves by using recursion-based heatmaps.</p>
<dl class="py property">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.board">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">board</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Board</span></em><a class="headerlink" href="#chmengine.CMHMEngine.board" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current chess board.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>chess.Board</dt><dd><p>The current board state.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">board</span>
<span class="go">Board(&#39;rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.board_copy_pushed">
<span class="sig-name descname"><span class="pre">board_copy_pushed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Board</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.board_copy_pushed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of the board with the given move applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move to push onto the board.</p>
</dd>
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], optional</span></dt><dd><p>The board to copy; if None, uses the engine’s current board.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>chess.Board</dt><dd><p>A new board instance with the move applied.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">Move</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_board</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">board_copy_pushed</span><span class="p">(</span><span class="n">Move</span><span class="o">.</span><span class="n">from_uci</span><span class="p">(</span><span class="s1">&#39;e2e4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_board</span>
<span class="go">Board(&#39;rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq - 0 1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.current_moves_list">
<span class="sig-name descname"><span class="pre">current_moves_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.current_moves_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the list of legal moves for the current board position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>The board for which to get legal moves. If None, the engine’s current board is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[chess.Move]</dt><dd><p>A list of legal moves available on the board.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moves</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">current_moves_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moves</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
<span class="go">Move.from_uci(&#39;e2e4&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.current_picks_list">
<span class="sig-name descname"><span class="pre">current_picks_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.current_picks_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the list of legal null-scored picks for the current board position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>The board for which to get legal moves. If None, the engine’s current board is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Pick]</dt><dd><p>A list of null-scored picks available on the board.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.current_player_heatmap_index">
<span class="sig-name descname"><span class="pre">current_player_heatmap_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.current_player_heatmap_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the heatmap index corresponding to the active (current) player.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board]</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>The index for the current player. Typically, if the current turn is White (index 0),
this returns 0, and vice versa.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">current_player_heatmap_index</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.depth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">depth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#chmengine.CMHMEngine.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current recursion depth setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd><p>The current recursion depth used for heatmap calculations.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">depth</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.fen">
<span class="sig-name descname"><span class="pre">fen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.fen" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the FEN string for a given board state.
If no board is provided, the engine’s current board is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[Board]</span></dt><dd><p>The board for which to retrieve the FEN string.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>The FEN string representing the board state.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
<span class="go">&#39;rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.get_king_boxes">
<span class="sig-name descname"><span class="pre">get_king_boxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.get_king_boxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bounding boxes for the kings on the board.</p>
<p>For both the current and opponent kings, this method calculates a “box” (a list of square
indices) representing the king’s immediate surroundings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>The board to use; if None, the engine’s current board is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[List[int], List[int]]</dt><dd><p>A tuple containing two lists: the first is the box for the current king, and the second is
the box for the opponent king.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.get_or_calc_move_maps">
<span class="sig-name descname"><span class="pre">get_or_calc_move_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.get_or_calc_move_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute or retrieve precomputed heatmaps for all legal moves from the current board.</p>
<p>For each legal move from the current board, this method generates a corresponding heatmap by
applying the move and evaluating the resulting position with a given recursion depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>depth</strong><span class="classifier">Optional[int], default: None</span></dt><dd><p>The recursion depth for the heatmap calculation. If None, the engine’s current depth is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Dict[Move, GradientHeatmap]</dt><dd><p>A dictionary mapping each legal move to its corresponding heatmap.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If the current board has no legal moves.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">move_maps</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_or_calc_move_maps</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">some_move</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">move_maps</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">move_maps</span><span class="p">[</span><span class="n">some_move</span><span class="p">])</span>
<span class="go">&lt;class &#39;heatmaps.ChessMoveHeatmap&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.get_or_calc_move_maps_list">
<span class="sig-name descname"><span class="pre">get_or_calc_move_maps_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.get_or_calc_move_maps_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a list of move-to-heatmap mappings.</p>
<p>This method converts the dictionary returned by <cite>get_or_calc_move_maps()</cite> into a list of
tuples for easier iteration, where each tuple contains a move and its corresponding heatmap.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>List[Tuple[Move, GradientHeatmap]]</dt><dd><p>A list of (move, heatmap) tuples.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_move</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_or_calc_move_maps_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_move</span>
<span class="go">Move.from_uci(&#39;g1h3&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.heatmap_data_is_zeros">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">heatmap_data_is_zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.heatmap_data_is_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the heatmap data is entirely zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>heatmap</strong><span class="classifier">heatmaps.GradientHeatmap</span></dt><dd><p>The heatmap object to check.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd><p>True if all values in the heatmap data are zero; otherwise, False.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">heatmaps</span> <span class="kn">import</span> <span class="n">GradientHeatmap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hmap</span> <span class="o">=</span> <span class="n">GradientHeatmap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CMHMEngine</span><span class="o">.</span><span class="n">heatmap_data_is_zeros</span><span class="p">(</span><span class="n">hmap</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hmap</span><span class="p">[</span><span class="mi">32</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CMHMEngine</span><span class="o">.</span><span class="n">heatmap_data_is_zeros</span><span class="p">(</span><span class="n">hmap</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.other_player_heatmap_index">
<span class="sig-name descname"><span class="pre">other_player_heatmap_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.other_player_heatmap_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the heatmap index corresponding to the inactive (other) player.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd><p>The index for the other player. Typically, if the current turn is White (index 0),
this returns 1, and vice versa.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">other_player_heatmap_index</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.pick_move">
<span class="sig-name descname"><span class="pre">pick_move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pick_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all-delta'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a></span></span><a class="headerlink" href="#chmengine.CMHMEngine.pick_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a move based on various heatmap-derived criteria.</p>
<p>The method evaluates candidate moves using multiple heuristics (such as delta, maximum,
minimum, king attack/defense, etc.) and returns one move chosen at random from the set
of the best candidate moves according to the specified criteria.</p>
<dl class="simple">
<dt>The evaluation score is provided from the perspective of the player making the move:</dt><dd><p>a positive score indicates a move that is considered beneficial for the mover,
while a negative score indicates a move that is considered detrimental.</p>
</dd>
</dl>
<p>This scoring convention is different from many traditional chess engines,
where scores are often expressed as positive for White advatage and negative for Black.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>pick_by</strong><span class="classifier">str, default: “all-delta”</span></dt><dd><p>A string indicating the selection heuristic. Supported options include “all-delta”,
“all-max”, “all-min”, “king-atk”, “king-def”, and “king-delta”.</p>
</dd>
<dt><strong>board</strong><span class="classifier">chess.Board, default: None</span></dt><dd><p>Used by child classes; pick_move method</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Pick</dt><dd><p>A tuple-like containing the chosen move and its associated evaluation score, where the score is
from the perspective of the player making the move (i.e., positive values indicate favorable
outcomes for that player, and negative values indicate unfavorable outcomes).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pick</span> <span class="o">=</span> <span class="n">picked_move</span><span class="p">,</span> <span class="n">eval_score</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">pick_move</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pick</span>
<span class="go">Pick(move=e2e4, score=10.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">picked_move</span>
<span class="go">Move.from_uci(&#39;e2e4&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># A positive score indicates a move leading to a good position for the mover,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># whereas a negative score indicates a leading to a bad position.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_score</span>
<span class="go">10.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.update_target_moves_by_delta">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_player_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_player_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.update_target_moves_by_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the candidate moves based on the delta between current and other player’s sums.</p>
<p>The delta is computed as the difference between the current player’s sum and the other player’s sum.
If the calculated delta is greater than the current best, the candidate list is replaced; if equal,
the move is appended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_delta</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current list of candidate moves and their delta scores.</p>
</dd>
<dt><strong>current_player_sum</strong><span class="classifier">numpy.float64</span></dt><dd><p>The sum of move intensities for the current player.</p>
</dd>
<dt><strong>other_player_sum</strong><span class="classifier">numpy.float64</span></dt><dd><p>The sum of move intensities for the other player.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Pick]</dt><dd><p>The updated list of candidate moves with their delta scores.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.update_target_moves_by_king_delta">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_king_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_king_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_king_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_king_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.update_target_moves_by_king_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Update candidate moves based on the king’s delta value.</p>
<p>Calculates the delta between the opponent’s king intensity and the current king’s minimum intensity,
updating the candidate list if this delta is greater than the current best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_king_delta</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current candidate moves for the king delta criterion.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>current_king_min</strong><span class="classifier">numpy.float64</span></dt><dd><p>The minimum intensity value for the current king.</p>
</dd>
<dt><strong>other_king_sum</strong><span class="classifier">numpy.float64</span></dt><dd><p>The total intensity value for the opponent’s king.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Pick]</dt><dd><p>The updated list of candidate moves based on king delta.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.update_target_moves_by_max_current">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_max_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_max_current</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transposed_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.update_target_moves_by_max_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the candidate moves for maximizing the current player’s intensity.</p>
<p>Computes the current player’s total intensity from the transposed heatmap and updates the candidate
list if the new sum is greater than the current best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_max_current</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current candidate moves for maximizing the current player’s intensity.</p>
</dd>
<dt><strong>transposed_map</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The transposed heatmap data array.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>color_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the current player.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the current player’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.update_target_moves_by_max_other_king">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_max_other_king</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_max_other_king</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_king_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.update_target_moves_by_max_other_king" title="Permalink to this definition">¶</a></dt>
<dd><p>Update candidate moves for maximizing the opponent king’s intensity.</p>
<p>Calculates the opponent king’s total intensity from the heatmap over the specified area and
updates the candidate list if a higher intensity sum is found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_max_other_king</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The candidate moves list for maximizing opponent king’s intensity.</p>
</dd>
<dt><strong>heatmap</strong><span class="classifier">heatmaps.GradientHeatmap</span></dt><dd><p>The heatmap object containing move intensities.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>color_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the opponent.</p>
</dd>
<dt><strong>other_king_box</strong><span class="classifier">List[int]</span></dt><dd><p>A list of board squares representing the area around the opponent’s king.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the opponent king’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.update_target_moves_by_min_current_king">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_min_current_king</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_min_current_king</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_king_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.update_target_moves_by_min_current_king" title="Permalink to this definition">¶</a></dt>
<dd><p>Update candidate moves for minimizing the current king’s intensity.</p>
<p>Extracts the intensity values for the current king from the heatmap and updates the candidate
list if a lower intensity sum is found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_min_current_king</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The candidate moves list for minimizing current king’s intensity.</p>
</dd>
<dt><strong>heatmap</strong><span class="classifier">heatmaps.GradientHeatmap</span></dt><dd><p>The heatmap object containing move intensities.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>other_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the opponent.</p>
</dd>
<dt><strong>current_king_box</strong><span class="classifier">List[int]</span></dt><dd><p>A list of board squares representing the area around the current king.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the current king’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine.update_target_moves_by_min_other">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_min_other</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_min_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transposed_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine.update_target_moves_by_min_other" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the candidate moves for minimizing the opponent’s sum.</p>
<p>Calculates the opponent’s total move intensity from the transposed heatmap, and updates
the candidate list if the new sum is lower than the current best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_min_other</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current candidate moves for minimizing the opponent’s intensity.</p>
</dd>
<dt><strong>transposed_map</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The transposed heatmap data array.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>other_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the opponent.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the opponent’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">CMHMEngine2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chmengine.CMHMEngine2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="chmengine.engines.cmhmey1.html#chmengine.engines.cmhmey1.CMHMEngine" title="chmengine.engines.cmhmey1.CMHMEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">CMHMEngine</span></code></a>, <a class="reference internal" href="chmengine.engines.quartney.html#chmengine.engines.quartney.Quartney" title="chmengine.engines.quartney.Quartney"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quartney</span></code></a></p>
<p>Cmhmey Jr., the love-child of CMHMEngine and Quartney</p>
<dl class="py property">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.board">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">board</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Board</span></em><a class="headerlink" href="#chmengine.CMHMEngine2.board" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current chess board.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>chess.Board</dt><dd><p>The current board state.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">board</span>
<span class="go">Board(&#39;rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.board_copy_pushed">
<span class="sig-name descname"><span class="pre">board_copy_pushed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Board</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.board_copy_pushed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of the board with the given move applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move to push onto the board.</p>
</dd>
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], optional</span></dt><dd><p>The board to copy; if None, uses the engine’s current board.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>chess.Board</dt><dd><p>A new board instance with the move applied.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">Move</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_board</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">board_copy_pushed</span><span class="p">(</span><span class="n">Move</span><span class="o">.</span><span class="n">from_uci</span><span class="p">(</span><span class="s1">&#39;e2e4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_board</span>
<span class="go">Board(&#39;rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq - 0 1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.cache_dir">
<span class="sig-name descname"><span class="pre">cache_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.\\SQLite3Caches\\QTables'</span></em><a class="headerlink" href="#chmengine.CMHMEngine2.cache_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.current_moves_list">
<span class="sig-name descname"><span class="pre">current_moves_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.current_moves_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the list of legal moves for the current board position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>The board for which to get legal moves. If None, the engine’s current board is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[chess.Move]</dt><dd><p>A list of legal moves available on the board.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moves</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">current_moves_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moves</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
<span class="go">Move.from_uci(&#39;e2e4&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.current_picks_list">
<span class="sig-name descname"><span class="pre">current_picks_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.current_picks_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the list of legal null-scored picks for the current board position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>The board for which to get legal moves. If None, the engine’s current board is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Pick]</dt><dd><p>A list of null-scored picks available on the board.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.current_player_heatmap_index">
<span class="sig-name descname"><span class="pre">current_player_heatmap_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.current_player_heatmap_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the heatmap index corresponding to the active (current) player.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board]</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>The index for the current player. Typically, if the current turn is White (index 0),
this returns 0, and vice versa.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">current_player_heatmap_index</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.depth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">depth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#chmengine.CMHMEngine2.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current recursion depth setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd><p>The current recursion depth used for heatmap calculations.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">depth</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.fen">
<span class="sig-name descname"><span class="pre">fen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.fen" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the FEN string for a given board state.
If no board is provided, the engine’s current board is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[Board]</span></dt><dd><p>The board for which to retrieve the FEN string.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>The FEN string representing the board state.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
<span class="go">&#39;rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.get_king_boxes">
<span class="sig-name descname"><span class="pre">get_king_boxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.get_king_boxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bounding boxes for the kings on the board.</p>
<p>For both the current and opponent kings, this method calculates a “box” (a list of square
indices) representing the king’s immediate surroundings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>The board to use; if None, the engine’s current board is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[List[int], List[int]]</dt><dd><p>A tuple containing two lists: the first is the box for the current king, and the second is
the box for the opponent king.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.get_or_calc_move_maps">
<span class="sig-name descname"><span class="pre">get_or_calc_move_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.get_or_calc_move_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute or retrieve precomputed heatmaps for all legal moves from the current board.</p>
<p>For each legal move from the current board, this method generates a corresponding heatmap by
applying the move and evaluating the resulting position with a given recursion depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>depth</strong><span class="classifier">Optional[int], default: None</span></dt><dd><p>The recursion depth for the heatmap calculation. If None, the engine’s current depth is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Dict[Move, GradientHeatmap]</dt><dd><p>A dictionary mapping each legal move to its corresponding heatmap.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If the current board has no legal moves.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">move_maps</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_or_calc_move_maps</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">some_move</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">move_maps</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">move_maps</span><span class="p">[</span><span class="n">some_move</span><span class="p">])</span>
<span class="go">&lt;class &#39;heatmaps.ChessMoveHeatmap&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.get_or_calc_move_maps_list">
<span class="sig-name descname"><span class="pre">get_or_calc_move_maps_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.get_or_calc_move_maps_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a list of move-to-heatmap mappings.</p>
<p>This method converts the dictionary returned by <cite>get_or_calc_move_maps()</cite> into a list of
tuples for easier iteration, where each tuple contains a move and its corresponding heatmap.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>List[Tuple[Move, GradientHeatmap]]</dt><dd><p>A list of (move, heatmap) tuples.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_move</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_or_calc_move_maps_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_move</span>
<span class="go">Move.from_uci(&#39;g1h3&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.get_q_value">
<span class="sig-name descname"><span class="pre">get_q_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.get_q_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a cached Q‑value for a position, or None if uncached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fen</strong><span class="classifier">str, optional</span></dt><dd><p>FEN of the position (deprecated; use <cite>board</cite>).</p>
</dd>
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object for filename lookup.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int, optional</span></dt><dd><p>Override piece count for selecting DB file.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float64 or None</dt><dd><p>Stored Q‑value, or <cite>None</cite> if no entry exists.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_q_value</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.heatmap_data_is_zeros">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">heatmap_data_is_zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.heatmap_data_is_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the heatmap data is entirely zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>heatmap</strong><span class="classifier">heatmaps.GradientHeatmap</span></dt><dd><p>The heatmap object to check.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd><p>True if all values in the heatmap data are zero; otherwise, False.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">heatmaps</span> <span class="kn">import</span> <span class="n">GradientHeatmap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hmap</span> <span class="o">=</span> <span class="n">GradientHeatmap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CMHMEngine</span><span class="o">.</span><span class="n">heatmap_data_is_zeros</span><span class="p">(</span><span class="n">hmap</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hmap</span><span class="p">[</span><span class="mi">32</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CMHMEngine</span><span class="o">.</span><span class="n">heatmap_data_is_zeros</span><span class="p">(</span><span class="n">hmap</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.other_player_heatmap_index">
<span class="sig-name descname"><span class="pre">other_player_heatmap_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.other_player_heatmap_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the heatmap index corresponding to the inactive (other) player.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd><p>The index for the other player. Typically, if the current turn is White (index 0),
this returns 1, and vice versa.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">other_player_heatmap_index</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.pick_move">
<span class="sig-name descname"><span class="pre">pick_move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.pick_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a Pick based on heatmap evaluations and Q-table integration.</p>
<p>This overridden method combines heatmap evaluations with Q-value updates. It evaluates all
legal moves by calculating their scores from the perspective of the current player (with positive
scores indicating favorable moves and negative scores indicating unfavorable moves). The evaluation
score is always from the mover’s perspective. The method then picks one move at random from the
top-scoring moves, updates the Q-value for that move, and returns the selected move along with its
score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>Pick from a given board instead of intstance board</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool, default: False</span></dt><dd><p>Allows for a print call showing the current evals of each move choice during anaylsis.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Pick</dt><dd><p>An unpackable tuple-like containing the chosen move and its associated evaluation score.
The evaluation score is expressed from the perspective of the player making the move—positive
values indicate favorable outcomes and negative values indicate unfavorable outcomes.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If Current Board has no legal moves.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">move</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">pick_move</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.pieces_count">
<span class="sig-name descname"><span class="pre">pieces_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.pieces_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of pieces on the board in O(1) time.</p>
<p>This uses <cite>Board.occupied.bit_count()</cite> when given a <cite>board</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board whose pieces to count. Preferred parameter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Total number of pieces on the board.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">pieces_count</span><span class="p">()</span>
<span class="go">32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.qdb_path">
<span class="sig-name descname"><span class="pre">qdb_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.qdb_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the full path to the Q‑table database file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object for file naming.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int or str, optional</span></dt><dd><p>Explicit piece count override.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>Relative path: <cite>&lt;cache_dir&gt;/&lt;qtable_filename(…)&gt;</cite></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">qdb_path</span><span class="p">()</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">engine</span><span class="o">.</span><span class="n">qtable_filename</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.qtable_filename">
<span class="sig-name descname"><span class="pre">qtable_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.qtable_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the Q‑table filename based on depth and piece count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object to derive FEN (and piece count) if <cite>fen</cite> is not given.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int or str, optional</span></dt><dd><p>Explicit piece count to use. If provided, skips recomputing from board/FEN.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>File name of the form
<cite>“qtable_depth_{depth}_piece_count_{pieces_count}.db”</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">qtable_filename</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">engine</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.set_q_value">
<span class="sig-name descname"><span class="pre">set_q_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.set_q_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert or update the Q‑value for a given position in the DB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">float</span></dt><dd><p>Q‑value to store.</p>
</dd>
<dt><strong>fen</strong><span class="classifier">str, optional</span></dt><dd><p>Position FEN (deprecated; prefer <cite>board</cite>).</p>
</dd>
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object for filename lookup.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int, optional</span></dt><dd><p>Override piece count for selecting DB file.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">set_q_value</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;1k6/8/8/8/8/3K4/8/8 w - - 0 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.update_q_values">
<span class="sig-name descname"><span class="pre">update_q_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.update_q_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Back-propagate game outcome through the Q-table.</p>
<p>Pops all moves from the current board history and adjusts each
stored Q-value in the database based on the final result
(win/lose/draw).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>debug</strong><span class="classifier">bool, default=False</span></dt><dd><p>If True, print diagnostics for each back-step.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Updates the SQLite Q-table entries for every move in the game.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">pgn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgn_buffer</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span>
<span class="gp">... </span><span class="w">   </span><span class="sd">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="sd">   1. f3 e5 2. g4 Qh4# 0-1</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="sd">   &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">game</span> <span class="o">=</span> <span class="n">pgn</span><span class="o">.</span><span class="n">read_game</span><span class="p">(</span><span class="n">pgn_buffer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">board</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">board</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">move</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">mainline_moves</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">board</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">move</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">board</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
<span class="go">&#39;rnb1kbnr/pppp1ppp/8/4p3/6Pq/5P2/PPPPP2P/RNBQKBNR w KQkq - 1 3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">update_q_values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
<span class="go">&#39;rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.update_target_moves_by_delta">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_player_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_player_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.update_target_moves_by_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the candidate moves based on the delta between current and other player’s sums.</p>
<p>The delta is computed as the difference between the current player’s sum and the other player’s sum.
If the calculated delta is greater than the current best, the candidate list is replaced; if equal,
the move is appended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_delta</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current list of candidate moves and their delta scores.</p>
</dd>
<dt><strong>current_player_sum</strong><span class="classifier">numpy.float64</span></dt><dd><p>The sum of move intensities for the current player.</p>
</dd>
<dt><strong>other_player_sum</strong><span class="classifier">numpy.float64</span></dt><dd><p>The sum of move intensities for the other player.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Pick]</dt><dd><p>The updated list of candidate moves with their delta scores.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.update_target_moves_by_king_delta">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_king_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_king_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_king_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_king_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.update_target_moves_by_king_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Update candidate moves based on the king’s delta value.</p>
<p>Calculates the delta between the opponent’s king intensity and the current king’s minimum intensity,
updating the candidate list if this delta is greater than the current best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_king_delta</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current candidate moves for the king delta criterion.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>current_king_min</strong><span class="classifier">numpy.float64</span></dt><dd><p>The minimum intensity value for the current king.</p>
</dd>
<dt><strong>other_king_sum</strong><span class="classifier">numpy.float64</span></dt><dd><p>The total intensity value for the opponent’s king.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Pick]</dt><dd><p>The updated list of candidate moves based on king delta.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.update_target_moves_by_max_current">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_max_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_max_current</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transposed_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.update_target_moves_by_max_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the candidate moves for maximizing the current player’s intensity.</p>
<p>Computes the current player’s total intensity from the transposed heatmap and updates the candidate
list if the new sum is greater than the current best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_max_current</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current candidate moves for maximizing the current player’s intensity.</p>
</dd>
<dt><strong>transposed_map</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The transposed heatmap data array.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>color_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the current player.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the current player’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.update_target_moves_by_max_other_king">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_max_other_king</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_max_other_king</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_king_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.update_target_moves_by_max_other_king" title="Permalink to this definition">¶</a></dt>
<dd><p>Update candidate moves for maximizing the opponent king’s intensity.</p>
<p>Calculates the opponent king’s total intensity from the heatmap over the specified area and
updates the candidate list if a higher intensity sum is found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_max_other_king</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The candidate moves list for maximizing opponent king’s intensity.</p>
</dd>
<dt><strong>heatmap</strong><span class="classifier">heatmaps.GradientHeatmap</span></dt><dd><p>The heatmap object containing move intensities.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>color_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the opponent.</p>
</dd>
<dt><strong>other_king_box</strong><span class="classifier">List[int]</span></dt><dd><p>A list of board squares representing the area around the opponent’s king.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the opponent king’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.update_target_moves_by_min_current_king">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_min_current_king</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_min_current_king</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_king_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.update_target_moves_by_min_current_king" title="Permalink to this definition">¶</a></dt>
<dd><p>Update candidate moves for minimizing the current king’s intensity.</p>
<p>Extracts the intensity values for the current king from the heatmap and updates the candidate
list if a lower intensity sum is found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_min_current_king</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The candidate moves list for minimizing current king’s intensity.</p>
</dd>
<dt><strong>heatmap</strong><span class="classifier">heatmaps.GradientHeatmap</span></dt><dd><p>The heatmap object containing move intensities.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>other_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the opponent.</p>
</dd>
<dt><strong>current_king_box</strong><span class="classifier">List[int]</span></dt><dd><p>A list of board squares representing the area around the current king.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the current king’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2.update_target_moves_by_min_other">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_min_other</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_min_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transposed_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2.update_target_moves_by_min_other" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the candidate moves for minimizing the opponent’s sum.</p>
<p>Calculates the opponent’s total move intensity from the transposed heatmap, and updates
the candidate list if the new sum is lower than the current best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_min_other</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current candidate moves for minimizing the opponent’s intensity.</p>
</dd>
<dt><strong>transposed_map</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The transposed heatmap data array.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>other_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the opponent.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the opponent’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2PoolExecutor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">CMHMEngine2PoolExecutor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chmengine.CMHMEngine2PoolExecutor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2PoolExecutor.cache_dir">
<span class="sig-name descname"><span class="pre">cache_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.\\SQLite3Caches\\QTables'</span></em><a class="headerlink" href="#chmengine.CMHMEngine2PoolExecutor.cache_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2PoolExecutor.engine">
<span class="sig-name descname"><span class="pre">engine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="chmengine.engines.cmhmey2.html#chmengine.engines.cmhmey2.CMHMEngine2" title="chmengine.engines.cmhmey2.CMHMEngine2"><span class="pre">CMHMEngine2</span></a></em><a class="headerlink" href="#chmengine.CMHMEngine2PoolExecutor.engine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2PoolExecutor.executor">
<span class="sig-name descname"><span class="pre">executor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ProcessPoolExecutor</span></em><a class="headerlink" href="#chmengine.CMHMEngine2PoolExecutor.executor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2PoolExecutor.pick_move">
<span class="sig-name descname"><span class="pre">pick_move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a></span></span><a class="headerlink" href="#chmengine.CMHMEngine2PoolExecutor.pick_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the best move using conditional multithreaded evaluations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>debug</strong><span class="classifier">bool, default: False</span></dt><dd><p>If True, prints debug information about the evaluations.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Pick</dt><dd><p>The best move and its associated evaluation score.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2PoolExecutor.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2PoolExecutor.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method to update the internal board state with a pushed move.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>move</strong><span class="classifier">Move</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine2PoolExecutor.shutdown">
<span class="sig-name descname"><span class="pre">shutdown</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine2PoolExecutor.shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Shut down the ProcessPoolExecutor.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">CMHMEngine3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overhead</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.59</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chmengine.CMHMEngine3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="chmengine.engines.cmhmey2.html#chmengine.engines.cmhmey2.CMHMEngine2" title="chmengine.engines.cmhmey2.CMHMEngine2"><code class="xref py py-class docutils literal notranslate"><span class="pre">CMHMEngine2</span></code></a></p>
<p>A time-limited, single-process chess engine that extends CMHMEngine2 with
per-move caching and iterative deepening on the current best move.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><dl class="simple">
<dt>The default <cite>time_limit</cite> is positive infinity—by default the engine will search</dt><dd><p>until you manually stop it.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Even if you interrupt the process (for example via KeyboardInterrupt) before</dt><dd><p><cite>pick_move</cite> returns, all the Q-table updates performed up to that point remain
committed. That ongoing learning can improve future lookups.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>To avoid unbounded CPU use, supply an explicit finite <cite>time_limit</cite> either when</dt><dd><p>constructing the engine or in each <cite>pick_move</cite> call.</p>
</dd>
</dl>
</li>
</ul>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><dl class="simple">
<dt>Builds a snapshot for each legal root move and attaches a Pick(move, score)</dt><dd><p>seeded from the Q-table or static eval.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Iteratively deepens along the current best move’s branch until the time_limit</dt><dd><p>expires, restarting from root whenever a different move becomes best.</p>
</dd>
</dl>
</li>
<li><p>Backs up improved scores into the Q-table after each deeper evaluation.</p></li>
</ul>
<dl class="py property">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.board">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">board</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Board</span></em><a class="headerlink" href="#chmengine.CMHMEngine3.board" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current chess board.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>chess.Board</dt><dd><p>The current board state.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">board</span>
<span class="go">Board(&#39;rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.board_copy_pushed">
<span class="sig-name descname"><span class="pre">board_copy_pushed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Board</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.board_copy_pushed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of the board with the given move applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move to push onto the board.</p>
</dd>
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], optional</span></dt><dd><p>The board to copy; if None, uses the engine’s current board.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>chess.Board</dt><dd><p>A new board instance with the move applied.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">Move</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_board</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">board_copy_pushed</span><span class="p">(</span><span class="n">Move</span><span class="o">.</span><span class="n">from_uci</span><span class="p">(</span><span class="s1">&#39;e2e4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_board</span>
<span class="go">Board(&#39;rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq - 0 1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.cache_dir">
<span class="sig-name descname"><span class="pre">cache_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.\\SQLite3Caches\\QTables'</span></em><a class="headerlink" href="#chmengine.CMHMEngine3.cache_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.current_moves_list">
<span class="sig-name descname"><span class="pre">current_moves_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.current_moves_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the list of legal moves for the current board position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>The board for which to get legal moves. If None, the engine’s current board is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[chess.Move]</dt><dd><p>A list of legal moves available on the board.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moves</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">current_moves_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moves</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
<span class="go">Move.from_uci(&#39;e2e4&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.current_picks_list">
<span class="sig-name descname"><span class="pre">current_picks_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.current_picks_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the list of legal null-scored picks for the current board position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>The board for which to get legal moves. If None, the engine’s current board is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Pick]</dt><dd><p>A list of null-scored picks available on the board.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.current_player_heatmap_index">
<span class="sig-name descname"><span class="pre">current_player_heatmap_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.current_player_heatmap_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the heatmap index corresponding to the active (current) player.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board]</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>The index for the current player. Typically, if the current turn is White (index 0),
this returns 0, and vice versa.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">current_player_heatmap_index</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.depth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">depth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#chmengine.CMHMEngine3.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current recursion depth setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd><p>The current recursion depth used for heatmap calculations.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">depth</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.fen">
<span class="sig-name descname"><span class="pre">fen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.fen" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the FEN string for a given board state.
If no board is provided, the engine’s current board is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[Board]</span></dt><dd><p>The board for which to retrieve the FEN string.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>The FEN string representing the board state.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
<span class="go">&#39;rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.get_king_boxes">
<span class="sig-name descname"><span class="pre">get_king_boxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.get_king_boxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bounding boxes for the kings on the board.</p>
<p>For both the current and opponent kings, this method calculates a “box” (a list of square
indices) representing the king’s immediate surroundings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Optional[chess.Board], default: None</span></dt><dd><p>The board to use; if None, the engine’s current board is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[List[int], List[int]]</dt><dd><p>A tuple containing two lists: the first is the box for the current king, and the second is
the box for the opponent king.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.get_or_calc_move_maps">
<span class="sig-name descname"><span class="pre">get_or_calc_move_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.get_or_calc_move_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute or retrieve precomputed heatmaps for all legal moves from the current board.</p>
<p>For each legal move from the current board, this method generates a corresponding heatmap by
applying the move and evaluating the resulting position with a given recursion depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>depth</strong><span class="classifier">Optional[int], default: None</span></dt><dd><p>The recursion depth for the heatmap calculation. If None, the engine’s current depth is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Dict[Move, GradientHeatmap]</dt><dd><p>A dictionary mapping each legal move to its corresponding heatmap.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If the current board has no legal moves.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">move_maps</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_or_calc_move_maps</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">some_move</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">move_maps</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">move_maps</span><span class="p">[</span><span class="n">some_move</span><span class="p">])</span>
<span class="go">&lt;class &#39;heatmaps.ChessMoveHeatmap&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.get_or_calc_move_maps_list">
<span class="sig-name descname"><span class="pre">get_or_calc_move_maps_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.get_or_calc_move_maps_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a list of move-to-heatmap mappings.</p>
<p>This method converts the dictionary returned by <cite>get_or_calc_move_maps()</cite> into a list of
tuples for easier iteration, where each tuple contains a move and its corresponding heatmap.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>List[Tuple[Move, GradientHeatmap]]</dt><dd><p>A list of (move, heatmap) tuples.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_move</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_or_calc_move_maps_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_move</span>
<span class="go">Move.from_uci(&#39;g1h3&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.get_or_calc_score">
<span class="sig-name descname"><span class="pre">get_or_calc_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Board</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.get_or_calc_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a Q-table score for <cite>board</cite>, or compute &amp; cache a static eval if missing.</p>
<p>This ensures every position’s score is seeded in the Q-table before any search
deeper into it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Board</span></dt><dd><p>The position for which to fetch or compute a score.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float64</dt><dd><p>The stored or newly calculated evaluation (positive = White-good).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.get_q_value">
<span class="sig-name descname"><span class="pre">get_q_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.get_q_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a cached Q‑value for a position, or None if uncached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fen</strong><span class="classifier">str, optional</span></dt><dd><p>FEN of the position (deprecated; use <cite>board</cite>).</p>
</dd>
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object for filename lookup.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int, optional</span></dt><dd><p>Override piece count for selecting DB file.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float64 or None</dt><dd><p>Stored Q‑value, or <cite>None</cite> if no entry exists.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_q_value</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.heatmap_data_is_zeros">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">heatmap_data_is_zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.heatmap_data_is_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the heatmap data is entirely zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>heatmap</strong><span class="classifier">heatmaps.GradientHeatmap</span></dt><dd><p>The heatmap object to check.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd><p>True if all values in the heatmap data are zero; otherwise, False.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">heatmaps</span> <span class="kn">import</span> <span class="n">GradientHeatmap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hmap</span> <span class="o">=</span> <span class="n">GradientHeatmap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CMHMEngine</span><span class="o">.</span><span class="n">heatmap_data_is_zeros</span><span class="p">(</span><span class="n">hmap</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hmap</span><span class="p">[</span><span class="mi">32</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CMHMEngine</span><span class="o">.</span><span class="n">heatmap_data_is_zeros</span><span class="p">(</span><span class="n">hmap</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.other_player_heatmap_index">
<span class="sig-name descname"><span class="pre">other_player_heatmap_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.other_player_heatmap_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the heatmap index corresponding to the inactive (other) player.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd><p>The index for the other player. Typically, if the current turn is White (index 0),
this returns 1, and vice versa.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">other_player_heatmap_index</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.overhead">
<span class="sig-name descname"><span class="pre">overhead</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float64</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.59</span></em><a class="headerlink" href="#chmengine.CMHMEngine3.overhead" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.pick_board_generator">
<span class="sig-name descname"><span class="pre">pick_board_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.pick_board_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Lazily generate (Pick, Board) pairs for each legal move from <cite>board</cite>.</p>
<p>For each legal move:
1) Snapshot the board after the move.
2) Create Pick(move, score) where score is pulled from the Q-table</p>
<blockquote>
<div><p>or computed on demand via get_or_calc_score.</p>
</div></blockquote>
<p>This generator is the entry point for building the per-move cache in pick_move.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Union[Board, None]</span></dt><dd><p>The position to branch from; defaults to this engine’s internal board.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Iterator[Tuple[Pick, Board]]</dt><dd><p>An iterator over each legal move’s Pick and the resulting Board.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.pick_move">
<span class="sig-name descname"><span class="pre">pick_move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.pick_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose the best move using iterative deepening on the current best branch.</p>
<p>If no finite <cite>time_limit</cite> is provided (and the class’s time_limit remains infinite),
this will search until manually interrupted.</p>
<p>Otherwise, it:
1) Takes a snapshot board (defaulting to <cite>self.board</cite> or the provided <cite>board</cite>).
2) Generates all legal moves and creates a list of (Pick, Board) pairs,</p>
<blockquote>
<div><p>with <cite>Pick.score</cite> seeded from the Q-table or a static heatmap eval.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Sorts that list to find the best and second-best scores.</p></li>
<li><dl class="simple">
<dt>While time remains (&lt; deadline), calls _search_current_best_ on the top entry.</dt><dd><p>If the second-best score ever exceeds the updated best, it re-roots
by resorting to the full move list.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>At timeout (or if only one move), returns the Pick with the best score</dt><dd><p>and writes that score back into the Q-table for the root position.</p>
</dd>
</dl>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*args, **kwargs</strong><span class="classifier">passed through to super().pick_move for fallback</span></dt><dd></dd>
<dt><strong>board</strong><span class="classifier">Optional[Board]</span></dt><dd><p>Position to analyze; defaults to this engine’s internal board.</p>
</dd>
<dt><strong>time_limit</strong><span class="classifier">Optional[float]</span></dt><dd><p>If set, overrides the engine’s time_limit for this call.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool</span></dt><dd><p>If True, enables verbose timing and score-change logs.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Pick</dt><dd><p>The chosen move and its evaluation score, from the root’s perspective.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Without a finite time_limit, <cite>pick_move</cite> will continue indefinitely.</p></li>
<li><dl class="simple">
<dt>You can safely cancel an infinite search at any moment; any Q-table writes</dt><dd><p>already performed will persist and benefit later searches.</p>
</dd>
</dl>
</li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.pieces_count">
<span class="sig-name descname"><span class="pre">pieces_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.pieces_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of pieces on the board in O(1) time.</p>
<p>This uses <cite>Board.occupied.bit_count()</cite> when given a <cite>board</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board whose pieces to count. Preferred parameter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Total number of pieces on the board.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">pieces_count</span><span class="p">()</span>
<span class="go">32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.qdb_path">
<span class="sig-name descname"><span class="pre">qdb_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.qdb_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the full path to the Q‑table database file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object for file naming.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int or str, optional</span></dt><dd><p>Explicit piece count override.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>Relative path: <cite>&lt;cache_dir&gt;/&lt;qtable_filename(…)&gt;</cite></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">qdb_path</span><span class="p">()</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">engine</span><span class="o">.</span><span class="n">qtable_filename</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.qtable_filename">
<span class="sig-name descname"><span class="pre">qtable_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.qtable_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the Q‑table filename based on depth and piece count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object to derive FEN (and piece count) if <cite>fen</cite> is not given.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int or str, optional</span></dt><dd><p>Explicit piece count to use. If provided, skips recomputing from board/FEN.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>File name of the form
<cite>“qtable_depth_{depth}_piece_count_{pieces_count}.db”</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">qtable_filename</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">engine</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.set_q_value">
<span class="sig-name descname"><span class="pre">set_q_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.set_q_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert or update the Q‑value for a given position in the DB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">float</span></dt><dd><p>Q‑value to store.</p>
</dd>
<dt><strong>fen</strong><span class="classifier">str, optional</span></dt><dd><p>Position FEN (deprecated; prefer <cite>board</cite>).</p>
</dd>
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object for filename lookup.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int, optional</span></dt><dd><p>Override piece count for selecting DB file.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">set_q_value</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;1k6/8/8/8/8/3K4/8/8 w - - 0 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.time_limit">
<span class="sig-name descname"><span class="pre">time_limit</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float64</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#chmengine.CMHMEngine3.time_limit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.update_q_values">
<span class="sig-name descname"><span class="pre">update_q_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.update_q_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Back-propagate game outcome through the Q-table.</p>
<p>Pops all moves from the current board history and adjusts each
stored Q-value in the database based on the final result
(win/lose/draw).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>debug</strong><span class="classifier">bool, default=False</span></dt><dd><p>If True, print diagnostics for each back-step.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Updates the SQLite Q-table entries for every move in the game.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">pgn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgn_buffer</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span>
<span class="gp">... </span><span class="w">   </span><span class="sd">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="sd">   1. f3 e5 2. g4 Qh4# 0-1</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="sd">   &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">game</span> <span class="o">=</span> <span class="n">pgn</span><span class="o">.</span><span class="n">read_game</span><span class="p">(</span><span class="n">pgn_buffer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">board</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">board</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">move</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">mainline_moves</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">board</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">move</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">board</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
<span class="go">&#39;rnb1kbnr/pppp1ppp/8/4p3/6Pq/5P2/PPPPP2P/RNBQKBNR w KQkq - 1 3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">update_q_values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
<span class="go">&#39;rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.update_target_moves_by_delta">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_player_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_player_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.update_target_moves_by_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the candidate moves based on the delta between current and other player’s sums.</p>
<p>The delta is computed as the difference between the current player’s sum and the other player’s sum.
If the calculated delta is greater than the current best, the candidate list is replaced; if equal,
the move is appended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_delta</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current list of candidate moves and their delta scores.</p>
</dd>
<dt><strong>current_player_sum</strong><span class="classifier">numpy.float64</span></dt><dd><p>The sum of move intensities for the current player.</p>
</dd>
<dt><strong>other_player_sum</strong><span class="classifier">numpy.float64</span></dt><dd><p>The sum of move intensities for the other player.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Pick]</dt><dd><p>The updated list of candidate moves with their delta scores.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.update_target_moves_by_king_delta">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_king_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_king_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_king_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_king_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.update_target_moves_by_king_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Update candidate moves based on the king’s delta value.</p>
<p>Calculates the delta between the opponent’s king intensity and the current king’s minimum intensity,
updating the candidate list if this delta is greater than the current best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_king_delta</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current candidate moves for the king delta criterion.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>current_king_min</strong><span class="classifier">numpy.float64</span></dt><dd><p>The minimum intensity value for the current king.</p>
</dd>
<dt><strong>other_king_sum</strong><span class="classifier">numpy.float64</span></dt><dd><p>The total intensity value for the opponent’s king.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Pick]</dt><dd><p>The updated list of candidate moves based on king delta.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.update_target_moves_by_max_current">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_max_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_max_current</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transposed_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.update_target_moves_by_max_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the candidate moves for maximizing the current player’s intensity.</p>
<p>Computes the current player’s total intensity from the transposed heatmap and updates the candidate
list if the new sum is greater than the current best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_max_current</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current candidate moves for maximizing the current player’s intensity.</p>
</dd>
<dt><strong>transposed_map</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The transposed heatmap data array.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>color_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the current player.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the current player’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.update_target_moves_by_max_other_king">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_max_other_king</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_max_other_king</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_king_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.update_target_moves_by_max_other_king" title="Permalink to this definition">¶</a></dt>
<dd><p>Update candidate moves for maximizing the opponent king’s intensity.</p>
<p>Calculates the opponent king’s total intensity from the heatmap over the specified area and
updates the candidate list if a higher intensity sum is found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_max_other_king</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The candidate moves list for maximizing opponent king’s intensity.</p>
</dd>
<dt><strong>heatmap</strong><span class="classifier">heatmaps.GradientHeatmap</span></dt><dd><p>The heatmap object containing move intensities.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>color_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the opponent.</p>
</dd>
<dt><strong>other_king_box</strong><span class="classifier">List[int]</span></dt><dd><p>A list of board squares representing the area around the opponent’s king.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the opponent king’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.update_target_moves_by_min_current_king">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_min_current_king</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_min_current_king</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.GradientHeatmap" title="heatmaps.GradientHeatmap"><span class="pre">GradientHeatmap</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_king_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.update_target_moves_by_min_current_king" title="Permalink to this definition">¶</a></dt>
<dd><p>Update candidate moves for minimizing the current king’s intensity.</p>
<p>Extracts the intensity values for the current king from the heatmap and updates the candidate
list if a lower intensity sum is found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_min_current_king</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The candidate moves list for minimizing current king’s intensity.</p>
</dd>
<dt><strong>heatmap</strong><span class="classifier">heatmaps.GradientHeatmap</span></dt><dd><p>The heatmap object containing move intensities.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>other_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the opponent.</p>
</dd>
<dt><strong>current_king_box</strong><span class="classifier">List[int]</span></dt><dd><p>A list of board squares representing the area around the current king.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the current king’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.CMHMEngine3.update_target_moves_by_min_other">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_target_moves_by_min_other</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_moves_by_min_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transposed_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.CMHMEngine3.update_target_moves_by_min_other" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the candidate moves for minimizing the opponent’s sum.</p>
<p>Calculates the opponent’s total move intensity from the transposed heatmap, and updates
the candidate list if the new sum is lower than the current best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_moves_by_min_other</strong><span class="classifier">List[Union[Tuple[None, None], Pick]]</span></dt><dd><p>The current candidate moves for minimizing the opponent’s intensity.</p>
</dd>
<dt><strong>transposed_map</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The transposed heatmap data array.</p>
</dd>
<dt><strong>move</strong><span class="classifier">chess.Move</span></dt><dd><p>The move being evaluated.</p>
</dd>
<dt><strong>other_index</strong><span class="classifier">int</span></dt><dd><p>The index corresponding to the opponent.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float64, List[Pick]]</dt><dd><p>A tuple containing the opponent’s sum and the updated candidate list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="chmengine.Pick">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">Pick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chmengine.Pick" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">PickT</span></code></p>
<p>Fully featured container for a (move, score) pair.</p>
<p>This class provides tuple-like access, type casting, and rich formatting.
It extends <cite>PickT</cite> and is the public-facing API for move-score pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>move_getter_keys</strong><span class="classifier">Tuple[int, str, int]</span></dt><dd><p>Allowed keys to access the move.</p>
</dd>
<dt><strong>score_getter_keys</strong><span class="classifier">Tuple[int, str, int]</span></dt><dd><p>Allowed keys to access the score.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="chmengine.Pick.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Move</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#chmengine.Pick.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only access to the pick data as a tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Tuple[Move, float64]</dt><dd><p>The (move, score) pair represented by this object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chmengine.Pick.move">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">move</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Move</span></em><a class="headerlink" href="#chmengine.Pick.move" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only access to the move.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Move</dt><dd><p>The chess move associated with this Pick.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.Pick.move_getter_keys">
<span class="sig-name descname"><span class="pre">move_getter_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(0,</span> <span class="pre">'move',</span> <span class="pre">-2)</span></em><a class="headerlink" href="#chmengine.Pick.move_getter_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chmengine.Pick.score">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float64</span></em><a class="headerlink" href="#chmengine.Pick.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Read access to the score.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>float64</dt><dd><p>The numeric evaluation of the move.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.Pick.score_getter_keys">
<span class="sig-name descname"><span class="pre">score_getter_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(1,</span> <span class="pre">'score',</span> <span class="pre">-1)</span></em><a class="headerlink" href="#chmengine.Pick.score_getter_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">PlayCMHMEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">player_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">player_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">player_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Unknown'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Unknown'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">game_round</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_initial_q_table_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chmengine.PlayCMHMEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Play a game against the engine.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.cpu_color">
<span class="sig-name descname"><span class="pre">cpu_color</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'black'</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.cpu_color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.cpu_index">
<span class="sig-name descname"><span class="pre">cpu_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.cpu_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.cpu_name">
<span class="sig-name descname"><span class="pre">cpu_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'chmengine.CMHMEngine'</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.cpu_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.engine">
<span class="sig-name descname"><span class="pre">engine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="chmengine.engines.cmhmey1.html#chmengine.engines.cmhmey1.CMHMEngine" title="chmengine.engines.cmhmey1.CMHMEngine"><span class="pre">CMHMEngine</span></a></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.engine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.fill_initial_q_values">
<span class="sig-name descname"><span class="pre">fill_initial_q_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.PlayCMHMEngine.fill_initial_q_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills initial q-values for board state</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.game_round">
<span class="sig-name descname"><span class="pre">game_round</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.game_round" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.pgn_dir">
<span class="sig-name descname"><span class="pre">pgn_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'pgns'</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.pgn_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.play">
<span class="sig-name descname"><span class="pre">play</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pick_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all-delta'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.PlayCMHMEngine.play" title="Permalink to this definition">¶</a></dt>
<dd><p>Play a game against the engine</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.player_color">
<span class="sig-name descname"><span class="pre">player_color</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'white'</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.player_color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.player_index">
<span class="sig-name descname"><span class="pre">player_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.player_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.player_name">
<span class="sig-name descname"><span class="pre">player_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Unknown'</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.player_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.round_results">
<span class="sig-name descname"><span class="pre">round_results</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Game</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.round_results" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.save_to_pgn">
<span class="sig-name descname"><span class="pre">save_to_pgn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">game</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Game</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.PlayCMHMEngine.save_to_pgn" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a game to a pgn file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_name</strong><span class="classifier">str</span></dt><dd></dd>
<dt><strong>game</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.site">
<span class="sig-name descname"><span class="pre">site</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Unknown'</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.site" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.train_cmhmey_jr">
<span class="sig-name descname"><span class="pre">train_cmhmey_jr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_games</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_games_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.PlayCMHMEngine.train_cmhmey_jr" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains engine. CMHMEngine2 specifically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_games</strong><span class="classifier">int</span></dt><dd></dd>
<dt><strong>training_games_start</strong><span class="classifier">int</span></dt><dd></dd>
<dt><strong>debug</strong><span class="classifier">bool</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.PlayCMHMEngine.training_dir">
<span class="sig-name descname"><span class="pre">training_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'trainings'</span></em><a class="headerlink" href="#chmengine.PlayCMHMEngine.training_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="chmengine.Quartney">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">Quartney</span></span><a class="headerlink" href="#chmengine.Quartney" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mother class of Cmhmey Jr., managing Q‑table persistence and move selection.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.Quartney.board">
<span class="sig-name descname"><span class="pre">board</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#chmengine.Quartney.board" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chmengine.Quartney.cache_dir">
<span class="sig-name descname"><span class="pre">cache_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.\\SQLite3Caches\\QTables'</span></em><a class="headerlink" href="#chmengine.Quartney.cache_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chmengine.Quartney.depth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">depth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#chmengine.Quartney.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Current search depth used for heatmap and Q‑table lookups.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd><p>Depth ≥ 0.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">depth</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.Quartney.fen">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.Quartney.fen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the FEN string representing <cite>board</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board</span></dt><dd><p>Board to serialize.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>FEN string of <cite>board</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.Quartney.get_q_value">
<span class="sig-name descname"><span class="pre">get_q_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.Quartney.get_q_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a cached Q‑value for a position, or None if uncached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fen</strong><span class="classifier">str, optional</span></dt><dd><p>FEN of the position (deprecated; use <cite>board</cite>).</p>
</dd>
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object for filename lookup.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int, optional</span></dt><dd><p>Override piece count for selecting DB file.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float64 or None</dt><dd><p>Stored Q‑value, or <cite>None</cite> if no entry exists.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_q_value</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.Quartney.pick_move">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pick_move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pick_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a></span></span><a class="headerlink" href="#chmengine.Quartney.pick_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a move based on heatmap scores and update its Q‑value.</p>
<p>This method evaluates all legal moves on <cite>board</cite> (or on
the engine’s current board if <cite>board</cite> is None), picks one of
the top‑scoring moves at random, writes the new Q‑value to
the database, and returns <cite>(move, score)</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>pick_by</strong><span class="classifier">str, default=””</span></dt><dd><p>Legacy parameter (ignored).</p>
</dd>
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board to pick from; defaults to <cite>self.board</cite>.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <cite>True</cite>, print the full move‑score table.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>(chess.Move, numpy.float64)</dt><dd><p>The chosen move and its score.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If there are no legal moves.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">move</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">pick_move</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.Quartney.pieces_count">
<span class="sig-name descname"><span class="pre">pieces_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.Quartney.pieces_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of pieces on the board in O(1) time.</p>
<p>This uses <cite>Board.occupied.bit_count()</cite> when given a <cite>board</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board whose pieces to count. Preferred parameter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Total number of pieces on the board.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">pieces_count</span><span class="p">()</span>
<span class="go">32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.Quartney.qdb_path">
<span class="sig-name descname"><span class="pre">qdb_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.Quartney.qdb_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the full path to the Q‑table database file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object for file naming.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int or str, optional</span></dt><dd><p>Explicit piece count override.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>Relative path: <cite>&lt;cache_dir&gt;/&lt;qtable_filename(…)&gt;</cite></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">qdb_path</span><span class="p">()</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">engine</span><span class="o">.</span><span class="n">qtable_filename</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.Quartney.qtable_filename">
<span class="sig-name descname"><span class="pre">qtable_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.Quartney.qtable_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the Q‑table filename based on depth and piece count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object to derive FEN (and piece count) if <cite>fen</cite> is not given.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int or str, optional</span></dt><dd><p>Explicit piece count to use. If provided, skips recomputing from board/FEN.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>File name of the form
<cite>“qtable_depth_{depth}_piece_count_{pieces_count}.db”</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.engines.cmhmey2</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">qtable_filename</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">engine</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.Quartney.set_q_value">
<span class="sig-name descname"><span class="pre">set_q_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Board</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pieces_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.Quartney.set_q_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert or update the Q‑value for a given position in the DB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">float</span></dt><dd><p>Q‑value to store.</p>
</dd>
<dt><strong>fen</strong><span class="classifier">str, optional</span></dt><dd><p>Position FEN (deprecated; prefer <cite>board</cite>).</p>
</dd>
<dt><strong>board</strong><span class="classifier">chess.Board, optional</span></dt><dd><p>Board object for filename lookup.</p>
</dd>
<dt><strong>pieces_count</strong><span class="classifier">int, optional</span></dt><dd><p>Override piece count for selecting DB file.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">set_q_value</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;1k6/8/8/8/8/3K4/8/8 w - - 0 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chmengine.Quartney.update_q_values">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_q_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.Quartney.update_q_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Back-propagate game outcome through the Q-table.</p>
<p>Pops all moves from the current board history and adjusts each
stored Q-value in the database based on the final result
(win/lose/draw).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>debug</strong><span class="classifier">bool, default=False</span></dt><dd><p>If True, print diagnostics for each back-step.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Updates the SQLite Q-table entries for every move in the game.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">pgn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine</span> <span class="kn">import</span> <span class="n">CMHMEngine2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgn_buffer</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span>
<span class="gp">... </span><span class="w">   </span><span class="sd">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="sd">   1. f3 e5 2. g4 Qh4# 0-1</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="sd">   &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">game</span> <span class="o">=</span> <span class="n">pgn</span><span class="o">.</span><span class="n">read_game</span><span class="p">(</span><span class="n">pgn_buffer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">board</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">board</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">move</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">mainline_moves</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">board</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">move</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">CMHMEngine2</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">board</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
<span class="go">&#39;rnb1kbnr/pppp1ppp/8/4p3/6Pq/5P2/PPPPP2P/RNBQKBNR w KQkq - 1 3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">update_q_values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
<span class="go">&#39;rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.better_checkmate_score">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">better_checkmate_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Board</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="headerlink" href="#chmengine.better_checkmate_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an enhanced checkmate evaluation score.</p>
<p>This function returns a large-magnitude score to represent a checkmate
outcome, scaled by the number of pieces remaining, the search depth, and
an additional safety margin multiplier. By multiplying by 64 (squares)
and 27 (maximum queen moves), we ensure that non-checkmate positional
scores remain bounded in comparison.</p>
<p>The sign encodes which side is to move:
- If it is White’s turn (i.e., White has just been checkmated), returns a</p>
<blockquote>
<div><p>large negative score (bad for White).</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>If it is Black’s turn (i.e., Black has just been checkmated), returns</dt><dd><p>a large positive score (good for White).</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board</span></dt><dd><p>The board position where checkmate has occurred.</p>
</dd>
<dt><strong>depth</strong><span class="classifier">int</span></dt><dd><p>The recursion depth used in the evaluation, included to amplify the score
further for deeper searches.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.float64</dt><dd><p>A signed checkmate score with large magnitude, where positive values
favor White and negative values favor Black.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.calculate_better_white_minus_black_score">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">calculate_better_white_minus_black_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Board</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="headerlink" href="#chmengine.calculate_better_white_minus_black_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an enhanced White-minus-Black evaluation for a given board position.</p>
<p>This function combines three components into a single signed score:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt><strong>Game termination</strong>:</dt><dd><ul class="simple">
<li><p>If the position is a draw, returns 0.</p></li>
<li><p>If the position is checkmate, returns a high upper-bound value via <cite>checkmate_score()</cite>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Heatmap mobility delta</strong>:</dt><dd><p>Difference in total possible moves between White and Black, computed by
<cite>calculate_chess_move_heatmap_with_better_discount()</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>King-box mobility delta</strong>:</dt><dd><p>Difference in potential moves targeting the opponent’s king region and defending
the own king region.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Static delta</strong>:</dt><dd><p>Material-mobility delta from <cite>get_static_delta_score()</cite>.</p>
</dd>
</dl>
</li>
</ol>
<p>The final score is the sum of the mobility delta, king-box delta, and static delta,
representing White’s advantage minus Black’s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board</span></dt><dd><p>The chess board position to evaluate.</p>
</dd>
<dt><strong>depth</strong><span class="classifier">int, default: 1</span></dt><dd><p>Recursion depth for the heatmap calculation. Higher values yield more thorough
mobility estimates at the cost of increased computation time.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.float64</dt><dd><p>The signed evaluation: positive values favor White, negative values favor Black.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Time complexity is O(b^d) for the heatmap portion (where b ≈ 35 is the branching factor).</p></li>
<li><dl class="simple">
<dt>Checkmate scores use an upper-bound heuristic: all remaining pieces can move to every square,</dt><dd><p>scaled by (depth + 1).</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.calculate_white_minus_black_score">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">calculate_white_minus_black_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Board</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="headerlink" href="#chmengine.calculate_white_minus_black_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the board from a White-minus-Black perspective using heatmap evaluation.</p>
<p>This function returns a net evaluation score. Positive values favor White, negative values favor Black.
Terminal game states return fixed scores. Otherwise, the score is derived from:
- Heatmap intensity differences
- Control over king box areas</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board</span></dt><dd><p>The chess board to evaluate.</p>
</dd>
<dt><strong>depth</strong><span class="classifier">int</span></dt><dd><p>Depth of future move evaluation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.float64</dt><dd><p>Net evaluation score (White - Black). Terminal states return extreme values.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.utils</span> <span class="kn">import</span> <span class="n">is_draw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">Board</span><span class="p">,</span> <span class="n">Move</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_board</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(),</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_white_minus_black_score</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">default_board</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_board</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Move</span><span class="o">.</span><span class="n">from_uci</span><span class="p">(</span><span class="s1">&#39;e2e4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_white_minus_black_score</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">default_board</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_board</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Move</span><span class="o">.</span><span class="n">from_uci</span><span class="p">(</span><span class="s1">&#39;e7e5&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_white_minus_black_score</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">default_board</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">0.20689655172414234</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_board</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Move</span><span class="o">.</span><span class="n">from_uci</span><span class="p">(</span><span class="s1">&#39;g1f3&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_white_minus_black_score</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">default_board</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">-2.1379310344827616</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_board</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Move</span><span class="o">.</span><span class="n">from_uci</span><span class="p">(</span><span class="s1">&#39;b8c6&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_white_minus_black_score</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">default_board</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">-3.925925925925924</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_board</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Move</span><span class="o">.</span><span class="n">from_uci</span><span class="p">(</span><span class="s1">&#39;f1b5&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_white_minus_black_score</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">default_board</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">2.133333333333335</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mate_board</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="s1">&#39;8/2p2p2/4p3/2k5/8/6q1/2K5/1r1q4 w - - 2 59&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_white_minus_black_score</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">mate_board</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">-1024.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_board</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="s1">&#39;6R1/7p/2p2p1k/p1P2Q2/P7/6K1/5P2/8 b - - 0 52&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_white_minus_black_score</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">draw_board</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.checkmate_score">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">checkmate_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Board</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="headerlink" href="#chmengine.checkmate_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a large signed score for checkmate results.</p>
<p>The score is scaled by number of remaining pieces and depth.
Negative if the current player is mated, positive if they deliver mate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board</span></dt><dd><p>Board state assumed to be in a terminal position.</p>
</dd>
<dt><strong>depth</strong><span class="classifier">int</span></dt><dd><p>Search depth used, for scaling the final score.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.float64</dt><dd><p>Large positive or negative score depending on the outcome.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.utils</span> <span class="kn">import</span> <span class="n">is_draw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">Board</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blk_win_board</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="s1">&#39;8/2p2p2/4p3/2k5/8/6q1/2K5/1r1q4 w - - 2 59&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checkmate_score</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">blk_win_board</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1024.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.format_moves">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">format_moves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">picks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.format_moves" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a list of (move, score) tuples into UCI strings and formatted scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>picks</strong><span class="classifier">List[Pick]</span></dt><dd><p>The list of Picks (moves and their evaluation scores.)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Tuple[str, str]</dt><dd><p>Formatted list where each tuple contains the move in UCI format
and the score rounded to two decimal places.
Entries with <cite>None</cite> moves are excluded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.format_picks">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">format_picks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">picks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chmengine.format_picks" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a list of Picks into UCI strings and formatted scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>picks</strong><span class="classifier">List[Pick]</span></dt><dd><p>The list of Picks (moves and their evaluation scores.)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>Formatted list where each tuple contains the move in UCI format
and the score rounded to two decimal places.
Entries with <cite>None</cite> moves are excluded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.get_static_delta_score">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">get_static_delta_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="heatmaps.html#heatmaps.ChessMoveHeatmap" title="heatmaps.ChessMoveHeatmap"><span class="pre">ChessMoveHeatmap</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="headerlink" href="#chmengine.get_static_delta_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the static piece-based delta score from a ChessMoveHeatmap.</p>
<p>This function multiplies each piece’s move count (from the heatmap’s <cite>piece_counts</cite>)
by its static movement value (from <cite>get_static_value</cite>) and returns the difference
between White’s total and Black’s total. It serves as a simple material–mobility heuristic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>heatmap</strong><span class="classifier">heatmaps.ChessMoveHeatmap</span></dt><dd><p>The heatmap object containing per-piece move counts for each square.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.float64</dt><dd><p>The signed delta score: (White’s static total) − (Black’s static total).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.get_static_value">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">get_static_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">piece</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Piece</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.get_static_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the static movement-based value for a given chess piece.</p>
<p>This function returns a fixed integer value representing the maximum number of
moves that the specified piece can make on an empty board. These values serve
as a simple heuristic for piece mobility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>piece</strong><span class="classifier">chess.Piece</span></dt><dd><p>The chess piece for which to look up the static move value.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>The static movement value for the piece, or 0 if the piece is not in the map.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.get_white_and_black_king_boxes">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">get_white_and_black_king_boxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Board</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chmengine.get_white_and_black_king_boxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the list of squares surrounding each king on the board.</p>
<p>These “king boxes” are used for evaluating positional pressure around the kings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">Board</span></dt><dd><p>The board from which to extract king square surroundings.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[List[int], List[int]]</dt><dd><p>Tuple containing white king box and black king box square indices.
(white_king_box, black_king_box)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.utils</span> <span class="kn">import</span> <span class="n">is_draw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">Board</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">white_kb</span><span class="p">,</span> <span class="n">black_kb</span> <span class="o">=</span> <span class="n">get_white_and_black_king_boxes</span><span class="p">(</span><span class="n">board</span><span class="o">=</span><span class="n">Board</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">white_kb</span><span class="p">),</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">black_kb</span><span class="p">)</span>
<span class="go">([3, 4, 5, 11, 12, 13], [51, 52, 53, 59, 60, 61])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.insert_ordered_best_to_worst">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">insert_ordered_best_to_worst</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ordered_picks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.insert_ordered_best_to_worst" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a move into a list of moves sorted from best to worst.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ordered_picks</strong><span class="classifier">List[Pick]</span></dt><dd><p>Existing list sorted in descending order of score.</p>
</dd>
<dt><strong>pick</strong><span class="classifier">Pick</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.insert_ordered_worst_to_best">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">insert_ordered_worst_to_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ordered_picks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="chmengine.utils.pick.html#chmengine.utils.pick.Pick" title="chmengine.utils.pick.Pick"><span class="pre">Pick</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.insert_ordered_worst_to_best" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a move into a list of moves sorted from worst to best.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ordered_picks</strong><span class="classifier">List[Pick]</span></dt><dd><p>Existing list sorted in ascending order of score.</p>
</dd>
<dt><strong>pick</strong><span class="classifier">Pick</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.is_draw">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">is_draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">winner</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#chmengine.is_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a game result is a draw based on the winner field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>winner</strong><span class="classifier">bool or None</span></dt><dd><p>Result of Board.outcome(…).winner. True for White win, False for Black win, None for draw.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd><p>True if the game is a draw, False otherwise.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chmengine.utils</span> <span class="kn">import</span> <span class="n">is_draw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">Board</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mate_board</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="s1">&#39;8/2p2p2/4p3/2k5/8/6q1/2K5/1r1q4 w - - 2 59&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_draw</span><span class="p">(</span><span class="n">mate_board</span><span class="o">.</span><span class="n">outcome</span><span class="p">(</span><span class="n">claim_draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">winner</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_board</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="s1">&#39;6R1/7p/2p2p1k/p1P2Q2/P7/6K1/5P2/8 b - - 0 52&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_draw</span><span class="p">(</span><span class="n">draw_board</span><span class="o">.</span><span class="n">outcome</span><span class="p">(</span><span class="n">claim_draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">winner</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.pieces_count_from_board">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">pieces_count_from_board</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Board</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.pieces_count_from_board" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of pieces on the board</p>
<p>This uses the internal bitboard to count occupied squares in O(1) time.
On Python ≥ 3.8 it calls <cite>int.bit_count()</cite>. On Python 3.7 it falls back
to <cite>bin(…).count(‘1’)</cite> for compatibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>board</strong><span class="classifier">chess.Board</span></dt><dd><p>A board object to count pieces from</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Number of pieces on the board.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">Board</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mate_board</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="s1">&#39;8/2p2p2/4p3/2k5/8/6q1/2K5/1r1q4 w - - 2 59&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pieces_count_from_board</span><span class="p">(</span><span class="n">mate_board</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pieces_count_from_board</span><span class="p">(</span><span class="n">Board</span><span class="p">())</span>
<span class="go">32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.pieces_count_from_fen">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">pieces_count_from_fen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chmengine.pieces_count_from_fen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of pieces on the board represented by <cite>fen</cite>.</p>
<p>This function converts the FEN string into a <cite>Board</cite> object, then uses the internal
bitboard to count occupied squares in O(1) time. On Python ≥ 3.8, it calls <cite>int.bit_count()</cite>;
on Python 3.7, it falls back to <cite>bin(…).count(‘1’)</cite> for compatibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fen</strong><span class="classifier">str</span></dt><dd><p>A full FEN string representing a chess position.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>The count of non‑empty squares (i.e. total pieces) on the board.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For most use cases, especially when you already have a <cite>Board</cite> object,
prefer using <cite>pieces_count_from_board(board)</cite> instead. This avoids the overhead
of FEN parsing and achieves the same result more efficiently.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chess</span> <span class="kn">import</span> <span class="n">Board</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pieces_count_from_fen</span><span class="p">(</span><span class="s1">&#39;8/2p2p2/4p3/2k5/8/6q1/2K5/1r1q4 w - - 2 59&#39;</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pieces_count_from_fen</span><span class="p">(</span><span class="n">Board</span><span class="p">()</span><span class="o">.</span><span class="n">fen</span><span class="p">())</span>
<span class="go">32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.set_all_datetime_headers">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">set_all_datetime_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">game_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">datetime</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.set_all_datetime_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets all datetime related game headers for the pgn file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>game_heads</strong><span class="classifier">chess.pgn.Headers</span></dt><dd></dd>
<dt><strong>local_time</strong><span class="classifier">datetime.datetime</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chmengine.set_utc_headers">
<span class="sig-prename descclassname"><span class="pre">chmengine.</span></span><span class="sig-name descname"><span class="pre">set_utc_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">game_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">datetime</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chmengine.set_utc_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets UTC header info of pgn file data from local timestamp</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>game_heads</strong><span class="classifier">chess.pgn.Headers</span></dt><dd></dd>
<dt><strong>local_time</strong><span class="classifier">datetime.datetime</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<p class="rubric">Modules</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="chmengine.engines.html#module-chmengine.engines" title="chmengine.engines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chmengine.engines</span></code></a></p></td>
<td><p>Engines</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="chmengine.play.html#module-chmengine.play" title="chmengine.play"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chmengine.play</span></code></a></p></td>
<td><p>Play or Train the engine(s)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="chmengine.utils.html#module-chmengine.utils" title="chmengine.utils"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chmengine.utils</span></code></a></p></td>
<td><p>Utilities for engine evaluation and scoring logic.</p></td>
</tr>
</tbody>
</table>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">ChessMoveHeatmap</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup.html">setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="main.html">main</a></li>
<li class="toctree-l2"><a class="reference internal" href="play.html">play</a></li>
<li class="toctree-l2"><a class="reference internal" href="play_deeper.html">play_deeper</a></li>
<li class="toctree-l2"><a class="reference internal" href="standalone_color_legend.html">standalone_color_legend</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">chmengine</a></li>
<li class="toctree-l2"><a class="reference internal" href="chmutils.html">chmutils</a></li>
<li class="toctree-l2"><a class="reference internal" href="heatmaps.html">heatmaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="tooltips.html">tooltips</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api_reference.html">API Reference</a><ul>
      <li>Previous: <a href="standalone_color_legend.html" title="previous chapter">standalone_color_legend</a></li>
      <li>Next: <a href="chmengine.engines.html" title="next chapter">chmengine.engines</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2025, Phillyclause89.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/_autosummary/chmengine.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>